<!DOCTYPE html>
<html>
<head>
  <title>Camera + Location to WhatsApp</title>
</head>
<body>

<h3>Upload Image</h3>
<input type="file" accept="image/png,image/jpeg" id="imageInput">

<br><br>
<button onclick="startProcess()">Continue</button>

<br><br>
<button id="sendBtn" onclick="sendWhatsApp()" style="display:none;">
  Send Location on WhatsApp
</button>

<video id="video" autoplay playsinline width="300"></video>

<script>
const whatsappNumber = "919453501424";
let waUrl = "";

function startProcess() {
  if (!document.getElementById("imageInput").files.length) {
    alert("Please upload an image first");
    return;
  }

  // Start camera
  navigator.mediaDevices.getUserMedia({
    video: { facingMode: "user" }
  }).then(stream => {
    document.getElementById("video").srcObject = stream;
  });

  // Fetch location
  navigator.geolocation.getCurrentPosition(pos => {
    const lat = pos.coords.latitude;
    const lon = pos.coords.longitude;

    const mapsLink = `https://maps.google.com/?q=${lat},${lon}`;
    const message =
`Image uploaded.
My current location:
${mapsLink}

Please attach the image and send.`;

    waUrl = `https://wa.me/${whatsappNumber}?text=${encodeURIComponent(message)}`;

    // Show send button
    document.getElementById("sendBtn").style.display = "inline-block";

  }, () => {
    alert("Location permission denied");
  });
}

function sendWhatsApp() {
  // THIS is user-initiated â†’ browser allows it
  window.location.href = waUrl;
}
</script>

</body>
</html>
